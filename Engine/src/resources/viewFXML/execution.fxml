<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx/17"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="ui.controllers.ExecutionController">

    <children>
        <TitledPane expanded="true" text="Debugger / Execution" VBox.vgrow="ALWAYS">
            <content>
                <VBox spacing="8">
                    <children>
                        <ToolBar>
                            <items>
                                <Button fx:id="btnRun"      text="Run"       onAction="#onRun"/>
                                <Button fx:id="btnDebug"    text="Debug"     onAction="#onDebug"/>
                                <Button fx:id="btnStepOver" text="Step Over" onAction="#onStepOver"/>
                                <Button fx:id="btnStepBack" text="Step Back" onAction="#onStepBack"/>
                                <Button fx:id="btnStop"     text="Stop"      onAction="#onStop"/>
                                <Button fx:id="btnResume"   text="Resume"      onAction="#onResume"/>
                            </items>
                        </ToolBar>

                        <GridPane hgap="10" vgap="10">
                            <columnConstraints>
                                <ColumnConstraints hgrow="ALWAYS" percentWidth="50"/>
                                <ColumnConstraints hgrow="ALWAYS" percentWidth="50"/>
                            </columnConstraints>
                            <rowConstraints>
                                <RowConstraints vgrow="ALWAYS"/>
                                <RowConstraints vgrow="SOMETIMES"/>
                            </rowConstraints>

                            <TitledPane expanded="true" text="Variables"
                                        GridPane.columnIndex="0" GridPane.rowIndex="0"
                                        GridPane.hgrow="ALWAYS" GridPane.vgrow="ALWAYS">
                                <content>
                                    <TableView fx:id="tblVariables" VBox.vgrow="ALWAYS">
                                        <columnResizePolicy>
                                            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
                                        </columnResizePolicy>
                                        <columns>
                                            <TableColumn fx:id="colVarName"  text="Name"  prefWidth="120" maxWidth="220"/>
                                            <TableColumn fx:id="colVarType"  text="Type"  prefWidth="100" maxWidth="160"/>
                                            <TableColumn fx:id="colVarValue" text="Value" prefWidth="120"/>
                                        </columns>
                                    </TableView>
                                </content>
                            </TitledPane>

                            <TitledPane expanded="true" text="Execution Inputs"
                                        GridPane.columnIndex="1" GridPane.rowIndex="0"
                                        GridPane.hgrow="ALWAYS" GridPane.vgrow="ALWAYS">
                                <content>
                                    <VBox spacing="6">
                                        <children>

                                            <ScrollPane fx:id="inputsScroll"
                                                        fitToWidth="true"
                                                        hbarPolicy="NEVER"
                                                        vbarPolicy="AS_NEEDED"
                                                        VBox.vgrow="ALWAYS">
                                                <content>
                                                    <VBox fx:id="inputsContainer"
                                                          spacing="6"
                                                          fillWidth="true"
                                                          stylesheets="@execution.css"/>
                                                </content>
                                            </ScrollPane>

                                            <!-- ספייסר (אם עדיין צריך אותו) -->
                                            <Pane VBox.vgrow="ALWAYS"/>

                                            <HBox fx:id="hBoxStart" alignment="TOP_CENTER">
                                                <children>
                                                    <Button fx:id="btnStart" text="Start" onAction="#onStart"/>
                                                </children>
                                            </HBox>
                                        </children>
                                    </VBox>
                                </content>
                            </TitledPane>


                            <TitledPane expanded="true" text="Cycles"
                                        GridPane.columnIndex="0" GridPane.rowIndex="1"
                                        GridPane.hgrow="ALWAYS">
                                <content>
                                    <VBox spacing="8">
                                        <children>
                                            <HBox alignment="CENTER_LEFT" spacing="6">
                                                <children>
                                                    <Label text="Total cycles:"/>
                                                    <Label fx:id="lblCycles" text="0"/>
                                                </children>
                                            </HBox>
                                            <ProgressBar fx:id="prgExecution" progress="0.0" maxWidth="Infinity"/>
                                        </children>
                                        <padding>
                                            <Insets top="8" right="8" bottom="8" left="8"/>
                                        </padding>
                                    </VBox>
                                </content>
                            </TitledPane>

                            <TitledPane expanded="true" text="Output (y)"
                                        GridPane.columnIndex="1" GridPane.rowIndex="1"
                                        GridPane.hgrow="ALWAYS">
                                <content>
                                    <VBox spacing="8">
                                        <children>
                                            <TextField fx:id="txtOutput" editable="false" promptText="y" maxWidth="Infinity"/>
                                        </children>
                                        <padding>
                                            <Insets top="8" right="8" bottom="8" left="8"/>
                                        </padding>
                                    </VBox>
                                </content>
                            </TitledPane>
                        </GridPane>
                    </children>
                </VBox>
            </content>
        </TitledPane>

        <fx:include source="history.fxml"/>
    </children>

    <padding>
        <Insets top="12" right="12" bottom="12" left="12"/>
    </padding>
</VBox>
